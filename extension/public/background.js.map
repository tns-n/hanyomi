{"version":3,"file":"background.js","mappings":"AAEAA,OAAOC,QAAQC,UAAUC,YAAY,SAACC,EAASC,EAAQC,GACrD,GAAuB,oBAAnBF,EAAQG,OAA8B,CAExC,IAAMC,EAAOJ,EAAQI,KAgBrB,OAfAC,MAAM,sCAADC,OAAuCC,mBAAmBH,KAC5DI,KAAK,SAACC,GACL,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAM,aAElB,OAAOF,EAASG,MAClB,GACCJ,KAAK,SAACK,GACLX,EAAa,CAAEY,SAAS,EAAMD,KAAAA,GAChC,GAAE,MACK,SAACE,GACNC,QAAQD,MAAM,eAAgBA,GAC9Bb,EAAa,CAAEY,SAAS,EAAOC,MAAOA,EAAMf,SAC9C,IAEK,CACT,CAEA,GAAuB,kBAAnBA,EAAQG,OAA4B,CAEtC,IAAMC,EAAOJ,EAAQI,KAgBrB,OAfAC,MAAM,2CAADC,OAA4CC,mBAAmBH,KACjEI,KAAK,SAACC,GACL,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAM,aAElB,OAAOF,EAASG,MAClB,GACCJ,KAAK,SAACK,GACLX,EAAa,CAAEY,SAAS,EAAMD,KAAAA,GAChC,GAAE,MACK,SAACE,GACNC,QAAQD,MAAM,eAAgBA,GAC9Bb,EAAa,CAAEY,SAAS,EAAOC,MAAOA,EAAMf,SAC9C,IAEK,CACT,CAEA,GAAuB,cAAnBA,EAAQG,OAYV,OAVAP,OAAOO,OACJc,YACAT,KAAK,WACJN,EAAa,CAAEY,SAAS,GAC1B,GAAE,MACK,SAACC,GACNC,QAAQD,MAAM,wBAAyBA,GACvCb,EAAa,CAAEY,SAAS,GAC1B,IAEK,EAGT,GAAuB,cAAnBd,EAAQG,OAAwB,CAElC,IAAQe,EAAsClB,EAAtCkB,SAAUC,EAA4BnB,EAA5BmB,UAAWC,EAAiBpB,EAAjBoB,OAAQC,EAASrB,EAATqB,KAErC,IAAKH,IAAaC,IAAcC,EAK9B,OAJAlB,EAAa,CACXY,SAAS,EACTC,MAAO,6DAEF,EAGT,IAAMO,EAAU,CACdJ,SAAAA,EACAC,UAAAA,EACAC,OAAAA,EACAC,KAAAA,GA6BF,OA1BAhB,MAAM,0CAA2C,CAC/CkB,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUL,KAEpBd,KAAK,SAACC,GACL,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAM,uBAADL,OAAwBG,EAASmB,SAElD,OAAOnB,EAASG,MAClB,GACCJ,KAAK,SAACK,GACLG,QAAQa,IAAI,qBAAsBhB,GAC9BA,EAAKE,MACPb,EAAa,CAAEY,SAAS,EAAOC,MAAOF,EAAKE,QAE3Cb,EAAa,CAAEY,SAAS,EAAMgB,OAAQjB,EAAKiB,QAE/C,GAAE,MACK,SAACf,GACNC,QAAQD,MAAM,qBAAsBA,GACpCb,EAAa,CAAEY,SAAS,EAAOC,MAAOA,EAAMf,SAC9C,IAEK,CACT,CACF","sources":["webpack://hanyomi-extension/./src/background.js"],"sourcesContent":["// Background service worker\r\n\r\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n  if (message.action === \"fetchDictionary\") {\r\n    // APIリクエストをバックグラウンドから実行\r\n    const word = message.word;\r\n    fetch(`http://localhost:3000/api/dic?word=${encodeURIComponent(word)}`)\r\n      .then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"API error\");\r\n        }\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        sendResponse({ success: true, data });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Fetch error:\", error);\r\n        sendResponse({ success: false, error: error.message });\r\n      });\r\n\r\n    return true; // 非同期応答を使用\r\n  }\r\n\r\n  if (message.action === \"fetchExamples\") {\r\n    // 例文APIリクエストをバックグラウンドから実行\r\n    const word = message.word;\r\n    fetch(`http://localhost:3000/api/examples?word=${encodeURIComponent(word)}`)\r\n      .then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"API error\");\r\n        }\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        sendResponse({ success: true, data });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Fetch error:\", error);\r\n        sendResponse({ success: false, error: error.message });\r\n      });\r\n\r\n    return true; // 非同期応答を使用\r\n  }\r\n\r\n  if (message.action === \"openPopup\") {\r\n    // ポップアップを開く処理\r\n    chrome.action\r\n      .openPopup()\r\n      .then(() => {\r\n        sendResponse({ success: true });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Failed to open popup:\", error);\r\n        sendResponse({ success: false });\r\n      });\r\n\r\n    return true;\r\n  }\r\n\r\n  if (message.action === \"addToAnki\") {\r\n    // Ankiカード追加処理\r\n    const { deckName, modelName, fields, tags } = message;\r\n\r\n    if (!deckName || !modelName || !fields) {\r\n      sendResponse({\r\n        success: false,\r\n        error: \"Missing required fields: deckName, modelName, or fields\",\r\n      });\r\n      return true;\r\n    }\r\n\r\n    const payload = {\r\n      deckName,\r\n      modelName,\r\n      fields,\r\n      tags,\r\n    };\r\n\r\n    fetch(\"http://localhost:3000/api/anki/add-card\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(payload),\r\n    })\r\n      .then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(\"Anki API response:\", data);\r\n        if (data.error) {\r\n          sendResponse({ success: false, error: data.error });\r\n        } else {\r\n          sendResponse({ success: true, cardId: data.cardId });\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Add to Anki error:\", error);\r\n        sendResponse({ success: false, error: error.message });\r\n      });\r\n\r\n    return true; // 非同期応答を使用\r\n  }\r\n});\r\n"],"names":["chrome","runtime","onMessage","addListener","message","sender","sendResponse","action","word","fetch","concat","encodeURIComponent","then","response","ok","Error","json","data","success","error","console","openPopup","deckName","modelName","fields","tags","payload","method","headers","body","JSON","stringify","status","log","cardId"],"ignoreList":[],"sourceRoot":""}